# DMD Lung Python
A Python Implementation of the "Dynamic Mode Decomposition of Dynamic MRI for Assessment of Pulmonary Ventilation and Perfusion"
This repository provides tools to analyze pulmonary ventilation and perfusion using Dynamic Mode Decomposition (DMD) applied to dynamic MRI data using Elastix Registration.

This technique is described in the following paper:

Ilicak, E, Ozdemir, S, Zapp, J, Schad, LR, Zöllner, FG. "Dynamic mode decomposition of dynamic MRI for assessment of pulmonary ventilation and perfusion". Magn Reson Med. 2023; 1- 9. doi: 10.1002/mrm.29656

https://onlinelibrary.wiley.com/doi/10.1002/mrm.29656

## MATLAB Implementation
A MATLAB version of this implementation is also available on:
https://github.com/EfeIlicak/DMD_Lung/
```

## Reference
You are encouraged to modify/distribute this code. However, please acknowledge this code and cite the paper appropriately. 

@article{https://doi.org/10.1002/mrm.29656,
author = {Ilicak, Efe and Ozdemir, Safa and Zapp, Jascha and Schad, Lothar R. and Zöllner, Frank G.},
title = {Dynamic mode decomposition of dynamic MRI for assessment of pulmonary ventilation and perfusion},
journal = {Magnetic Resonance in Medicine},
volume = {n/a},
number = {n/a},
pages = {},
keywords = {dynamic mode decomposition, Fourier decomposition, lung, lung function, matrix pencil, pulmonary MRI},
doi = {https://doi.org/10.1002/mrm.29656},
url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.29656},
eprint = {https://onlinelibrary.wiley.com/doi/pdf/10.1002/mrm.29656},
abstract = {Purpose To introduce dynamic mode decomposition (DMD) as a robust alternative for the assessment of pulmonary functional information from dynamic non-contrast-enhanced acquisitions. Methods Pulmonary fractional ventilation and normalized perfusion maps were obtained using DMD from simulated phantoms as well as in vivo dynamic acquisitions of healthy volunteers at 1.5T. The performance of DMD was compared with conventional Fourier decomposition (FD) and matrix pencil (MP) methods in estimating functional map values. The proposed method was evaluated based on estimated signal amplitude in functional maps across varying number of measurements. Results Quantitative assessments performed on phantoms and in vivo measurements indicate that DMD is capable of successfully obtaining pulmonary functional maps. Specifically, compared to FD and MP methods, DMD is able to reduce variations in estimated amplitudes across different number of measurements. This improvement is evident in the fractional ventilation and normalized perfusion maps obtain from phantom simulations with frequency variations and noise, as well as in the maps obtained from in vivo measurements. Conclusions A robust method for accurately estimating pulmonary ventilation and perfusion related signal changes in dynamic acquisitions is presented. The proposed method uses DMD to obtain functional maps reliably, while reducing amplitude variations caused by differences in number of measurements.}
}

```
